;/*FB_PKG_DELIM*/

__d("LSUpdateOngoingCallServerInfoData",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(n){return t.db.table(23).put({threadKey:e[0],ongoingCallServerInfoData:e[1],willExpandToNewThread:e[2],ongoingCallTimestampMs:e[3]})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSMailboxUpdateOngoingCallServerInfoDataStoredProcedure",e.__tables__=["rtc_ongoing_calls_on_threads_v2"],a.exports=e}),null);
__d("LSUpdateSyncGroupForThreadType",["LSArrayGetObjectAt"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return r[0]=t.i64.of_int32(e[0].length),t.i64.gt(r[0],t.i64.cast([0,0]))?t.loopAsync(r[0],function(o){return r[1]=o,t.sequence([function(o){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),e[0],r[1]).then(function(e){var t;return t=e,r[2]=t[0],r[3]=t[1],t})},function(o){return t.forEach(t.db.table(9).fetch([[[r[2]]],"threadTypeLastActivityTimestampMs"]),function(o){var a=o.item;return t.sequence([function(o){return r[5]=a.threadKey,r[6]=a.syncGroup,t.i64.neq(r[6],e[1])&&e[3]?t.sequence([function(o){return r[7]=new t.Map,r[7].set("thread_key",r[5]),r[7].set("calling_db",e[2]),r[7].set("thread_type",r[2]),r[7].set("thread_folder",a.folderName),r[8]=new t.Map,r[8].set("sync_group",e[1]),r[9]=new t.Map,r[9].set("sync_group",r[6]),r[10]=new t.Map,r[10].set("callsite","updateSyncGroupForThreadType"),r[11]=r[8].keys(),r[12]=t.i64.of_int32(r[11].length),t.i64.gt(r[12],t.i64.cast([0,0]))?t.loopAsync(r[12],function(e){return r[17]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[11],r[17]).then(function(e){var t;return t=e,r[18]=t[0],r[19]=t[1],t})},function(e){return r[20]=r[8].get(r[18]),r[10].set(["expected_",r[18]].join(""),r[20])}])}):t.resolve()},function(e){return r[13]=r[9].keys(),r[14]=t.i64.of_int32(r[13].length),t.i64.gt(r[14],t.i64.cast([0,0]))?t.loopAsync(r[14],function(e){return r[17]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[13],r[17]).then(function(e){var t;return t=e,r[18]=t[0],r[19]=t[1],t})},function(e){return r[20]=r[9].get(r[18]),r[10].set(["actual_",r[18]].join(""),r[20])}])}):t.resolve()},function(e){return r[15]=r[7].keys(),r[16]=t.i64.of_int32(r[15].length),t.i64.gt(r[16],t.i64.cast([0,0]))?t.loopAsync(r[16],function(e){return r[17]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[15],r[17]).then(function(e){var t;return t=e,r[18]=t[0],r[19]=t[1],t})},function(e){return r[20]=r[7].get(r[18]),r[10].set(r[18],r[20])}])}):t.resolve()}]):t.resolve()},function(n){return e[4]?r[4]=e[1]:r[4]=r[6],t.forEach(t.db.table(9).fetch([[[r[5]]]]),function(e){var t=e.update,n=e.item;return t({syncGroup:r[4]})})}])})}])}):t.resolve()},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxUpdateSyncGroupForThreadTypeStoredProcedure",e.__tables__=["threads"],a.exports=e}),null);